<!-- cl-start -->
## История версий

**version 1.1.1**    
- исправлено описание опции НДС.    

**version 1.1.0**    
- добавлена поддержка экспресс доставки.    

**version 1.0.49**    
- ошибка проверки подключения скрипта Яндекс карт.    

**version 1.0.48**    
- добавлены опции настройки для ключей Яндекс карты; - !обязательно заполните ключи в настройках модуля или поиск по карте работать не будет.    

**version 1.0.47**    
- улучшение совместимости с php 8.1, баг на странице настроек модуля.    

**version 1.0.46**    
- фикс проверки типа в Helper::pennyInt.    

**version 1.0.45**    
- фикс бага php с преобразованием чисел в int.    

**version 1.0.44**    
- ошибка приведения типов с ценой у товара выше 2 знаков после запятой.    

**version 1.0.43**    
- добавлен параметр referral_source со значением 1сbitrix_AWZ, для учета яндексом типа модуля доставки.    

**version 1.0.42**    
- замена setHeaders на более старый setHeader (для работы модуля на более ранних версий битрикса);    
- замена POST на GET в получении истории статусов (изменения в апи яндекса).    

**version 1.0.41**    
- баг фикс (Accessing static property ::$parent as non static).    

**version 1.0.40**    
- замена текста при выборе адреса доставки на карте для курьера и автозакрытие окна.    

**version 1.0.39**    
- фикс отображения кнопки выбора ПВЗ в отгрузке, если в заказе не яндекс доставка.    

**version 1.0.38**    
- замена объемного веса на габариты (объемный вес будет отключен с 23 марта);    
- исправлены габариты посылки для курьера.    

**version 1.0.37**    
- исключение из лога pickup list;    
- добавлено получение адреса с модуля yandex.market;    
- логика вывода карты для отметки GPS;    
- добавлены агенты расчета сроков;    
- добавлен параметр НДС;    
- добавлен выбор срока ПВЗ по умолчанию;    
- улучшения поддержки yandex.market;    
- фикс регулярок проверки точки ПВЗ при расчете;    
- улучшение алгоритма получения текущего ПВЗ при расчете;    
- добавлен статический кеш доступных ПВЗ для дальнейших расчетов доставки на обработчике onSaleDeliveryServiceCalculate;    
- добавлен учет времени добавления с расчета сроков при расчете сроков;    
- рефакторинг;    
- добавлен параметр доп. срока доставки в контроллер, для карты и последующих расчетов;    
- добавлен обработчик в контроллер для переопределения или фильтрации вывода списка ПВЗ на карту;    
- замена deprecated CUtil::InitJSCore;    
- добавление опций выбора вида точки на карте;    
- добавление выбора доступных интервалов доставки перед запросом офферов;    
- улучшена совместимость с php 8.1.    

**version 1.0.35**    
- добавлен выбор координат доставки на карте (опция в профиле доставки, обязательно наличие ключа яндекс карт в модуле fileman).    

**version 1.0.33**    
- ошибка учета добавленного времени с настроек профиля в ручной заявке.    

**version 1.0.32**    
- исправлена ошибка кеширования;    
- ошибка получения ПВЗ кандидата с наименьшим сроком из кеша;    
- исправлена ошибка заполнения очереди, если сменить доставку и не удалить заявку.    

**version 1.0.31**    
- ошибка получения ПВЗ кандидата с наименьшим сроком из кеша.    

**version 1.0.30**    
- исправлена ошибка кеширования.    

**version 1.0.29**    
- улучшен выбор ПВЗ по умолчанию для расчета;    
- добавлены опции кеширования в настройки доставки;    
- добавлен алгоритм умного выбора ПВЗ по умолчанию для расчета срока доставки.    

**version 1.0.28**    
- добавлена возможность отмены изменения статуса на обработчике onBeforeStatusUpdate, добавлен параметр lastDate позволяющий установить следующую дату проверки статуса.    

**version 1.0.27**    
- изменения в языковых переменных.    

**version 1.0.26**    
- исправлена ошибка проверки лицензии в битриксе, добавлен параметр для добавления часов (часового пояса) к сроку доставки передаваемому в Яндекс Доставку (баг с часовыми поясами в Апи Яндекса).    

**version 1.0.25**    
- логика списка заявок вынесена в отдельный класс, для возможности наследования на обработчике кастомизации списка заявок.    

**version 1.0.24**    
- исправлена ошибка сериализации заголовков HttpClient в логе, добавлен токен в статический кеш запросов (возможна ошибка, если аккаунты разные и одни параметры запроса).    

**version 1.0.23**    
- hard fix, добавлено получение ид точки самовывоза для расчета стоимости доставки (временный отвал или изменения в апи Яндекса).    

**version 1.0.22**    
- добавлено обновление сроков доставки после выбора пвз на карте;    
- изменен алгоритм подключения поиска адреса на карте (скрыта установка метки найденного адреса).    

**version 1.0.21**    
- конфликт в именовании переменных в обработчике onBeforeStatusUpdate.    

**version 1.0.20**    
- запрет выбора ПВЗ всех типов, кроме terminal и pickup_point.    

**version 1.0.19**    
- добавлена опция логирования запросов в b_event_log;    
- добавлен статический кеш запросов с одинаковыми параметрами в рамках одного хита.    

**version 1.0.18**    
- добавлен обработчик onAfterLocationNameCreate позволяющий переопределить название местоположение Битрикса перед расчетом;    
- исправлена ошибка кеша параметров доставки при нескольких профилях и пустом заказе;    
- исправлена ошибка получения параметров веса и объема по умолчанию при отсутствии доставки при расчете (баг в ядре);    
- добавлена опция в профили доставки (расчет сроков от с начала дня, от 00:00).    

**version 1.0.17**    
- исправлена ошибка не подстановки пустых параметров при ручной заявке в доставку;    
- исправлена ошибка получения кода местоположения при выборе ПВЗ в админке (дня нового импорта местоположений);    
- добавлен учет параметров максималдьных габаритов и веса при выводе доставки;    
- добавлено скрытие терминалов если габариты превышают допустимые, но все еще можно доставить до ПВЗ;    
- добавлена обработчка внешних ПВЗ и автоподстановка с модуля yandex.market;    
- добавлено получение габаритов товара с модуля торгового каталога в заявку.    

**version 1.0.16**    
- исправлена ошибка формирования штрихкода со случайными данными (добавлен статический кеш по номеру заказа, в рамках хита).    

**version 1.0.15**    
- улучшение поиска местоположений, фикс старых местоположений по ид (deprecated, будет удалено в будущих версиях).    

**version 1.0.14**    
- добавлена возможность задать свойство с координатами доставки;    
- улучшения проверки данных из заказа.    

**version 1.0.13**    
- исправлена ошибка сохранения фильтра в списке заявок;    
- изменение логики синхронизации статусов, добавлен контроль дубликатов статусов (необходима перенастройка автоматизации в модуле);    
- добавлено больше информации по автоматизации в заявку;    
- добавлена возможность настройки автоматизации с истории в заявке;    
- изменен тип колонки со статусом в базе (varchar(255)).    

**version 1.0.12**    
- добавлена поддержка множественных фильтров в список заявок.    

**version 1.0.11**    
- добавлена фильтрация по последнему статусу заявки в логистической платформе.    

**version 1.0.10**    
- в обработчик OnCalcBeforeReturn добавлена обработка параметра RESULT как алиаса к result, параметра disableWriteDate, отключающего запись даты в свойство;    
- улучшения проверки идентификаторов при записи даты доставки в свойство;    
- добавлена возможность обновления информации о доставке и вывод дополнительных данных в заявку;    
- добавлены функции получения ярлыков и актов;    
- добавлен фильтр по статусу заказов, по варианту доставки в списке заявок;    
- добавлена ссылка на заказ в списке заявок;    
- добавлен обработчик onBeforeShowListItems для кастомизации страницы списка заявок.    

**version 1.0.9**    
- изменен механизм подготовки данных для ручного оформления заказа;    
- добавлен вывод системной информации по запросу списка офферов;    
- исправления в языковых переменных;    
- добавлена опция отключения поиска адреса на карте (для работы требуется ключ сервиса Яндекс Карты).    

**version 1.0.8**    
- улучшена логика фильтрации заказов при обновлении статусов.    

**version 1.0.7**    
- добавлены обработчики в механизм смены статусов заказа;    
- исправлена ошибка не учета предыдущих статусов, если изменений больше чем 1.    

**version 1.0.6**    
- изменение проверки подписи в main 20.200.300.    

**version 1.0.4**    
- исправлена ошибка отображения профиля в созданных доставках.    
<!-- cl-end -->